<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ëã±Ë™û„ÅÆ‰øùÂÅ•ÂÆ§ÔºöÊÄùËÄÉ„ÅÆ„Çπ„Ç≠„É£„Éã„É≥„Ç∞ÁâπË®ì</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React and Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap');
        body { 
            font-family: 'Noto Sans JP', sans-serif; 
            margin: 0;
            background-color: #fdf8f1;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // --- Áã¨Ëá™„Ç¢„Ç§„Ç≥„É≥„Ç≥„É≥„Éù„Éº„Éç„É≥„ÉàÔºàJSX„Éï„É©„Ç∞„É°„É≥„Éà„Çí‰ΩøÁî®„Åó„Å¶„Ç®„É©„Éº„Çí‰øÆÊ≠£Ôºâ ---
        const Icon = ({ name, size = 24, className = "", fill = "none" }) => {
            const icons = {
                timer: <path d="M10 2h4M12 14v-4M4 13a8 8 0 0 1 8-8 8 8 0 1 1-5.3 14L4 17.6M9 17l1 1" />,
                checkCircle: (
                    <>
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                        <polyline points="22 4 12 14.01 9 11.01" />
                    </>
                ),
                xCircle: (
                    <>
                        <circle cx="12" cy="12" r="10" />
                        <line x1="15" y1="9" x2="9" y2="15" />
                        <line x1="9" y1="9" x2="15" y2="15" />
                    </>
                ),
                play: <polygon points="5 3 19 12 5 21 5 3" />,
                rotateCcw: (
                    <>
                        <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
                        <polyline points="3 3 3 8 8 8" />
                    </>
                ),
                award: (
                    <>
                        <circle cx="12" cy="8" r="7" />
                        <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88" />
                    </>
                ),
                arrowRight: (
                    <>
                        <line x1="5" y1="12" x2="19" y2="12" />
                        <polyline points="12 5 19 12 12 19" />
                    </>
                ),
                heart: <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />,
                coffee: (
                    <>
                        <path d="M18 8h1a4 4 0 0 1 0 8h-1" />
                        <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z" />
                        <line x1="6" y1="1" x2="6" y2="4" />
                        <line x1="10" y1="1" x2="10" y2="4" />
                        <line x1="14" y1="1" x2="14" y2="4" />
                    </>
                ),
                leaf: (
                    <>
                        <path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 3.5 1 8a7 7 0 0 1-9 10Z" />
                        <path d="M11 20a10.4 10.4 0 0 0 4-7.5" />
                    </>
                ),
                sparkles: <path d="m12 3 1.912 5.813a2 2 0 0 0 1.275 1.275L21 12l-5.813 1.912a2 2 0 0 0-1.275 1.275L12 21l-1.912-5.813a2 2 0 0 0-1.275-1.275L3 12l5.813-1.912a2 2 0 0 0 1.275-1.275L12 3Z" />,
                lightbulb: (
                    <>
                        <path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A5 5 0 0 0 8 8c0 1.3.5 2.6 1.5 3.5.8.8 1.3 1.5 1.5 2.5" />
                        <path d="M9 18h6" />
                        <path d="M10 22h4" />
                    </>
                ),
                shuffle: (
                    <>
                        <polyline points="16 3 21 3 21 8" />
                        <line x1="4" y1="20" x2="21" y2="3" />
                        <polyline points="21 16 21 21 16 21" />
                        <line x1="15" y1="15" x2="21" y2="21" />
                        <line x1="4" y1="4" x2="9" y2="9" />
                    </>
                ),
                chevronRight: <polyline points="9 18 15 12 9 6" />
            };
            return (
                <svg width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {icons[name]}
                </svg>
            );
        };

        const App = () => {
            const [gameState, setGameState] = useState('start'); 
            const [currentLevelIdx, setCurrentLevelIdx] = useState(0);
            const [shuffledLevels, setShuffledLevels] = useState([]);
            const [score, setScore] = useState(0);
            const [timeLeft, setTimeLeft] = useState(300); 
            const [feedback, setFeedback] = useState(null); 
            const [combo, setCombo] = useState(0);
            const [showThinkingPoint, setShowThinkingPoint] = useState(false);
            const [selectedOption, setSelectedOption] = useState(null);

            const allLevels = [
                { type: "„ÄêÂÖ∑‰Ωì ‚Üí ÊäΩË±°„Äë", target: "hamsters, rabbits, and guinea pigs", options: ["small pet animals", "aquatic creatures", "wild predators", "colorful birds"], answer: "small pet animals", thinking: "ÂÄãÂà•„ÅÆÂãïÁâ©„ÅÆÂêçÂâç„Çí„ÄéÂ∞èÂãïÁâ©„Äè„Å®„ÅÑ„ÅÜ„Ç´„ÉÜ„Ç¥„É™„Éº„Å´„Åæ„Å®„ÇÅ„Å¶„ÅÑ„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÂÖ∑‰Ωì ‚Üí ÊäΩË±°„Äë", target: "from 9:00 AM to 5:00 PM", options: ["during the daytime", "throughout the night", "at sunset", "twice a week"], answer: "during the daytime", thinking: "ÂÖ∑‰ΩìÁöÑ„Å™ÊôÇÂàª„Çí„ÄéÊó•‰∏≠„Äè„Å®„ÅÑ„ÅÜÊôÇÈñìÊ¶ÇÂøµ„Å´Â§âÊèõ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÂÖ∑‰Ωì ‚Üí ÊäΩË±°„Äë", target: "well tested and controlled", options: ["properly assessed", "newly invented", "cheap and fast", "dangerous to use"], answer: "properly assessed", thinking: "„Äé„ÉÜ„Çπ„Éà„ÉªÂà∂Âæ°„Åï„Çå„Çã„Äè„Çí„ÄéÈÅ©Âàá„Å´Ë©ï‰æ°ÔºàassessedÔºâ„Åï„Çå„Çã„Äè„Å®„ÅÑ„ÅÜÊ¶ÇÂøµ„Å´„ÄÇ2025Âπ¥Á¨¨5Âïè„ÅÆÈáçË¶ÅË°®Áèæ„ÄÇ" },
                { type: "„ÄêÂÖ∑‰Ωì ‚Üí ÊäΩË±°„Äë", target: "no permit is required", options: ["can use it freely", "must pay a fee", "limited access", "only for students"], answer: "can use it freely", thinking: "„ÄéË®±ÂèØ‰∏çË¶Å„ÄèÔºù„ÄéËá™Áî±„Å´‰Ωø„Åà„Çã„Äè„Å®„ÅÑ„ÅÜÂà§Êñ≠Âäõ„ÇíÂïè„ÅÜË®Ä„ÅÑÊèõ„Åà„Åß„Åô„ÄÇ" },
                { type: "„ÄêÂÖ∑‰Ωì ‚Üí ÊäΩË±°„Äë", target: "farthest from the entrance", options: ["at the back of the area", "near the front door", "beside the exit", "in the middle"], answer: "at the back of the area", thinking: "ÂÖ•Âè£„Åã„ÇâÊúÄ„ÇÇÈÅ†„ÅÑÔºù„Äé‰∏ÄÁï™Â••„Äè„ÇíÊåá„Åó„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÂÖ∑‰Ωì ‚Üí ÊäΩË±°„Äë", target: "every Monday and Thursday", options: ["twice a week", "on weekends", "every other day", "daily"], answer: "twice a week", thinking: "ÁâπÂÆö„ÅÆÊõúÊó•„Çí„ÄéÈÄ±„Å´‰ΩïÂõû„Äè„Å®„ÅÑ„ÅÜÈ†ªÂ∫¶„Å´ÊäΩË±°Âåñ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÂÖ∑‰Ωì ‚Üí ÊäΩË±°„Äë", target: "within 10 minutes on foot", options: ["walking distance", "by public transport", "an hour drive", "near the station"], answer: "walking distance", thinking: "„ÄéÂæíÊ≠©10ÂàÜ‰ª•ÂÜÖ„Äè„Çí„ÄéÂæíÊ≠©ÂúèÂÜÖ„Äè„Å®Ë®Ä„ÅÑÊèõ„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÂÖ∑‰Ωì ‚Üí ÊäΩË±°„Äë", target: "soft grass on the floor", options: ["vegetation bedding", "sandy ground", "wooden tiles", "plastic cover"], answer: "vegetation bedding", thinking: "„ÄéËçâÔºàgrassÔºâ„Äè„Çí„ÄéÊ§çÁâ©ÔºàvegetationÔºâ„Äè„Å®„ÅÑ„ÅÜ‰∏ä‰ΩçË™û„Å´Â§âÊèõ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÂÖ∑‰Ωì ‚Üí ÊäΩË±°„Äë", target: "discount for students", options: ["reduced price for learners", "free admission", "full-price tickets", "group reservation"], answer: "reduced price for learners", thinking: "„ÄéÂ≠¶ÁîüÂâ≤Âºï„Äè„Çí„ÄéÂ≠¶ÁøíËÄÖ„ÅÆ„Åü„ÇÅ„ÅÆ‰æ°Ê†ºÊ∏õÂÖç„Äè„Å®Ë™¨ÊòéÁöÑ„Å´Ë®Ä„ÅÑÊèõ„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÂÖ∑‰Ωì ‚Üí ÊäΩË±°„Äë", target: "18 years old and over", options: ["adults only", "children only", "for families", "all ages"], answer: "adults only", thinking: "Âπ¥ÈΩ¢Âà∂Èôê„Çí„ÄéÂ§ß‰∫∫ÈôêÂÆö„Äè„Å®„ÅÑ„ÅÜ„Ç´„ÉÜ„Ç¥„É™„Éº„Å´ÊäΩË±°Âåñ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÊäΩË±° ‚Üí ÂÖ∑‰Ωì„Äë", target: "outdoor activities", options: ["hiking and camping", "coding and gaming", "reading and writing", "sleeping and dreaming"], answer: "hiking and camping", thinking: "„ÄéÂ±ãÂ§ñÊ¥ªÂãï„Äè„ÅÆÂÖ∑‰ΩìÁöÑ„Å™‰∏≠Ë∫´„ÇíÁâπÂÆö„Åô„Çã„Éà„É¨„Éº„Éã„É≥„Ç∞„Åß„Åô„ÄÇ" },
                { type: "„ÄêÊäΩË±° ‚Üí ÂÖ∑‰Ωì„Äë", target: "medical facilities", options: ["hospitals and clinics", "theaters and parks", "banks and stores", "factories and farms"], answer: "hospitals and clinics", thinking: "„ÄéÂåªÁôÇÊñΩË®≠„Äè„Å®„ÅÑ„ÅÜË®ÄËëâ„Åã„Çâ„ÄÅÂÖ∑‰ΩìÁöÑ„Å™Â†¥ÊâÄ„ÇíÊÉ≥Ëµ∑„Åó„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÊäΩË±° ‚Üí ÂÖ∑‰Ωì„Äë", target: "academic achievements", options: ["good grades and awards", "delicious food", "new clothes", "fast cars"], answer: "good grades and awards", thinking: "„ÄéÂ≠¶Ê•≠„ÅÆÊàêÊûú„Äè„ÇíÂÖ∑‰ΩìÁöÑ„Å™ÊàêÁ∏æ„ÇÑË≥û„Å´Èñ¢ÈÄ£‰ªò„Åë„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÊäΩË±° ‚Üí ÂÖ∑‰Ωì„Äë", target: "digital devices", options: ["smartphones and tablets", "pens and pencils", "chairs and tables", "shoes and socks"], answer: "smartphones and tablets", thinking: "„Äé„Éá„Ç∏„Çø„É´Ê©üÂô®„Äè„ÅÆÂÖ∑‰Ωì‰æã„Çí„Çπ„Ç≠„É£„É≥„Åó„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÊäΩË±° ‚Üí ÂÖ∑‰Ωì„Äë", target: "tropical fruits", options: ["mangoes and pineapples", "apples and pears", "grapes and cherries", "peaches and plums"], answer: "mangoes and pineapples", thinking: "„Ç´„ÉÜ„Ç¥„É™„Éº„ÇíÂÖ∑‰ΩìÁöÑ„Å™ÂêçÂâç„Å´ÂàÜËß£„Åô„ÇãÁ∑¥Áøí„Åß„Åô„ÄÇ" },
                { type: "„ÄêÊäΩË±° ‚Üí ÂÖ∑‰Ωì„Äë", target: "dairy products", options: ["milk and cheese", "meat and fish", "bread and rice", "sugar and salt"], answer: "milk and cheese", thinking: "„Äé‰π≥Ë£ΩÂìÅ„Äè„Å´Âê´„Åæ„Çå„ÇãÂÖ∑‰ΩìÁöÑ„Å™È£üÂìÅ„ÇíÈÅ∏„Å≥„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÊäΩË±° ‚Üí ÂÖ∑‰Ωì„Äë", target: "seasonal changes", options: ["spring, summer, fall, winter", "morning, noon, evening", "north, south, east, west", "red, blue, yellow"], answer: "spring, summer, fall, winter", thinking: "„ÄéÂ≠£ÁØÄ„ÅÆÁßª„ÇäÂ§â„Çè„Çä„Äè„ÅÆ‰∏≠Ë∫´„ÇíÂÖ∑‰ΩìÁöÑ„Å´ÁâπÂÆö„Åó„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÊäΩË±° ‚Üí ÂÖ∑‰Ωì„Äë", target: "emergency contacts", options: ["police and ambulance", "friends and family", "teachers and staff", "shop and cafe"], answer: "police and ambulance", thinking: "„ÄéÁ∑äÊÄ•ÈÄ£Áµ°ÂÖà„Äè„Å®„ÅÑ„ÅÜÊ¶ÇÂøµ„ÇíÂÖ∑‰ΩìÁöÑ„Å™Ê©üÈñ¢„Å´Áµê„Å≥„Å§„Åë„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÊäΩË±° ‚Üí ÂÖ∑‰Ωì„Äë", target: "natural disasters", options: ["earthquakes and floods", "sunshine and rainbow", "festivals and events", "music and art"], answer: "earthquakes and floods", thinking: "„ÄéËá™ÁÑ∂ÁÅΩÂÆ≥„Äè„Å®„ÅÑ„ÅÜÊäΩË±°Ë™û„ÇíÂÖ∑‰ΩìÁöÑ„Å™ÁèæË±°„Å´ÁøªË®≥„Åó„Åæ„Åô„ÄÇ" },
                { type: "„ÄêÊäΩË±° ‚Üí ÂÖ∑‰Ωì„Äë", target: "daily necessities", options: ["food and water", "luxury watches", "designer bags", "sports cars"], answer: "food and water", thinking: "„ÄéÁîüÊ¥ªÂøÖÈúÄÂìÅ„Äè„Å®„ÅÑ„ÅÜË®ÄËëâ„Åå‰Ωï„ÇíÊåá„Åô„Åã„ÇíÂà§Êñ≠„Åó„Åæ„Åô„ÄÇ" }
            ];

            const shuffleArray = (array) => {
                const newArr = [...array];
                for (let i = newArr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [newArr[i], newArr[j]] = [newArr[j], newArr[i]];
                }
                return newArr;
            };

            const startGame = () => {
                const preparedLevels = shuffleArray(allLevels).map(level => ({
                    ...level,
                    options: shuffleArray(level.options)
                }));
                setShuffledLevels(preparedLevels);
                setGameState('playing');
                setCurrentLevelIdx(0);
                setScore(0);
                setTimeLeft(300);
                setCombo(0);
                setFeedback(null);
                setShowThinkingPoint(false);
                setSelectedOption(null);
            };

            const handleSelectAnswer = useCallback((option) => {
                if (showThinkingPoint) return;
                const isCorrect = option === shuffledLevels[currentLevelIdx].answer;
                setSelectedOption(option);
                if (isCorrect) {
                    setScore(prev => prev + 5); 
                    setCombo(prev => prev + 1);
                    setFeedback('correct');
                } else {
                    setCombo(0);
                    setFeedback('wrong');
                }
                setShowThinkingPoint(true);
            }, [currentLevelIdx, shuffledLevels, showThinkingPoint]);

            const handleGoToNext = () => {
                if (currentLevelIdx < shuffledLevels.length - 1) {
                    setCurrentLevelIdx(prev => prev + 1);
                    setFeedback(null);
                    setShowThinkingPoint(false);
                    setSelectedOption(null);
                } else {
                    setGameState('result');
                }
            };

            useEffect(() => {
                let timer;
                if (gameState === 'playing' && timeLeft > 0 && !showThinkingPoint) {
                    timer = setInterval(() => setTimeLeft(prev => prev - 1), 1000);
                } else if (timeLeft === 0) {
                    setGameState('result');
                }
                return () => clearInterval(timer);
            }, [gameState, timeLeft, showThinkingPoint]);

            const theme = { bg: "bg-[#fdf8f1]", card: "bg-white", primary: "bg-[#ffb7b2]", primaryHover: "hover:bg-[#ff9a9e]", secondary: "bg-[#a8dadc]", textMain: "text-[#5a4d44]", textSub: "text-[#8e7e74]" };

            return (
                <div className={`min-h-screen ${theme.bg} flex items-center justify-center p-4 ${theme.textMain}`}>
                    <div className={`w-full max-w-md ${theme.card} rounded-[3.5rem] shadow-[0_30px_70px_rgba(180,160,140,0.2)] overflow-hidden border-8 border-white flex flex-col min-h-[720px] relative transition-all duration-700`}>
                        
                        <div className="absolute -top-20 -right-20 w-64 h-64 bg-[#ffefef] rounded-full blur-[80px] opacity-60"></div>
                        <div className="absolute -bottom-20 -left-20 w-64 h-64 bg-[#f0f9f0] rounded-full blur-[80px] opacity-60"></div>

                        <div className="p-7 flex justify-between items-center relative z-10">
                            <div className="flex items-center gap-2.5 text-[#b8a398]">
                                <div className="bg-[#fff9f0] p-1.5 rounded-lg shadow-inner flex items-center justify-center">
                                    <Icon name="leaf" size={16} className="text-[#a8dadc]" />
                                </div>
                                <span className="text-[10px] font-bold tracking-[0.25em] uppercase opacity-70">The Healing Room</span>
                            </div>
                            {gameState === 'playing' && (
                                <div className={`flex items-center gap-2 font-bold px-4 py-2 rounded-full shadow-sm transition-all ${timeLeft < 30 ? 'bg-red-50 text-red-400 font-black' : 'bg-white text-[#ff9a9e]'}`}>
                                    <Icon name="timer" size={16} /> <span className="font-mono">{timeLeft}s</span>
                                </div>
                            )}
                        </div>

                        {gameState === 'start' && (
                            <div className="flex-grow flex flex-col items-center justify-center p-10 text-center relative z-10 animate-in fade-in duration-1000">
                                <div className="w-32 h-32 bg-[#fff9f0] rounded-full flex items-center justify-center text-[#e8b69d] mb-10 shadow-inner border-4 border-white relative">
                                    <Icon name="coffee" size={56} />
                                    <div className="absolute -top-2 -right-2 bg-white p-2 rounded-full shadow-md text-[#ffb7b2] animate-pulse">
                                        <Icon name="heart" size={20} fill="currentColor" />
                                    </div>
                                </div>
                                <h2 className="text-3xl font-bold mb-5 tracking-tight leading-tight text-slate-800">ÊÄùËÄÉ„ÅÆ„Çπ„Ç≠„É£„Éã„É≥„Ç∞<br/><span className="text-[#ffb7b2]">20Âïè„Éª100ÁÇπÊ∫ÄÁÇπ</span></h2>
                                <p className={`${theme.textSub} text-[14px] mb-12 leading-relaxed px-4 font-medium italic`}>„ÄåÂêå„ÅòÂçòË™û„Äç„ÇíÊé¢„Åô„ÅÆ„ÅØ„ÇÇ„ÅÜÂçíÊ•≠„ÄÇ<br/>Ëß£Ë™¨„Çí„Åò„Å£„Åè„ÇäË™≠„Çì„Åß„ÄÅËá™ÂàÜ„ÅÆ„Éö„Éº„Çπ„Åß<br/><b>„ÄåÊÄùËÄÉ„ÅÆ„Éñ„É™„ÉÉ„Ç∏„Äç</b>„Çí„Éû„Çπ„Çø„Éº„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇüåø</p>
                                <button onClick={startGame} className={`w-full ${theme.primary} ${theme.primaryHover} text-white font-bold py-6 px-8 rounded-full text-xl shadow-xl shadow-[#ffb7b2/30] transition-all active:scale-95 flex items-center justify-center gap-3`}>
                                    <Icon name="play" size={24} fill="white" /> ÁâπË®ì„Çí„ÅØ„Åò„ÇÅ„Çã
                                </button>
                                <p className="mt-8 text-[9px] font-bold tracking-[0.3em] uppercase opacity-30 italic">Madoka's English Infirmary</p>
                            </div>
                        )}

                        {gameState === 'playing' && shuffledLevels.length > 0 && (
                            <div className="flex-grow flex flex-col p-8 relative z-10 animate-in fade-in duration-500">
                                <div className="flex justify-between items-center mb-8">
                                    <div className="text-left">
                                        <span className="text-[10px] font-black text-[#b8a398] uppercase tracking-[0.2em] block mb-2 opacity-80 italic">{shuffledLevels[currentLevelIdx].type}</span>
                                        <div className="text-2xl font-black italic text-[#e8b69d]">Score: {score}</div>
                                    </div>
                                    <div className="text-right">
                                        <div className="text-[10px] font-bold text-[#dcd0c9] mb-2 tracking-widest">{currentLevelIdx + 1} / 20</div>
                                        <div className="flex gap-1 max-w-[90px] flex-wrap justify-end">
                                            {[...Array(20)].map((_, i) => (
                                                <div key={i} className={`h-1.5 w-1.5 rounded-full transition-all duration-300 ${i <= currentLevelIdx ? 'bg-[#ffb7b2] scale-110 shadow-sm' : 'bg-slate-100'}`}></div>
                                            ))}
                                        </div>
                                    </div>
                                </div>

                                <div className="bg-[#fffcf8] border-2 border-[#f5efeb] p-8 rounded-[3rem] text-center mb-10 relative shadow-sm min-h-[160px] flex items-center justify-center">
                                    <span className="absolute -top-3 left-1/2 -translate-x-1/2 bg-white px-5 py-1.5 rounded-full border border-[#f5efeb] text-[10px] font-black text-[#b8a398] uppercase tracking-[0.2em] italic shadow-sm">Target Phrase</span>
                                    <h3 className={`text-xl font-bold transition-all duration-500 ${showThinkingPoint ? 'scale-90 text-[#8e7e74] italic' : 'scale-100'}`}>"{shuffledLevels[currentLevelIdx].target}"</h3>
                                </div>

                                {!showThinkingPoint ? (
                                    <div className="grid grid-cols-1 gap-3.5 animate-in fade-in duration-300">
                                        <span className="text-[9px] font-bold text-[#b8a398] uppercase tracking-[0.2em] mb-2 ml-5 italic opacity-60">„Åµ„Åï„Çè„Åó„ÅÑË°®Áèæ„ÇíÈÅ∏„Å∂Ôºö</span>
                                        {shuffledLevels[currentLevelIdx].options.map((option, idx) => (
                                            <button key={idx} onClick={() => handleSelectAnswer(option)} className="w-full p-4.5 text-left rounded-[1.5rem] border-2 border-transparent bg-[#f9f5f2] hover:bg-white hover:border-[#ffb7b2] hover:shadow-lg transition-all font-bold text-[#7a6a5f] text-sm flex justify-between items-center group relative overflow-hidden active:scale-95">
                                                <span className="relative z-10">{option}</span>
                                                <Icon name="arrowRight" size={18} className="text-[#dcd0c9] group-hover:text-[#ffb7b2] group-hover:translate-x-1.5 transition-all" />
                                            </button>
                                        ))}
                                    </div>
                                ) : (
                                    <div className="animate-in fade-in slide-in-from-bottom-4 duration-700 flex flex-col flex-grow">
                                        <div className={`w-full p-5 mb-6 rounded-[1.5rem] border-2 flex justify-between items-center shadow-sm ${selectedOption === shuffledLevels[currentLevelIdx].answer ? 'border-[#82c182] bg-[#f0f9f0]' : 'border-[#ff9a9e] bg-[#fff5f5]'}`}>
                                            <div className="flex items-center gap-3 font-bold text-sm">
                                                {selectedOption === shuffledLevels[currentLevelIdx].answer ? <Icon name="checkCircle" size={20} className="text-[#82c182]" /> : <Icon name="xCircle" size={20} className="text-[#ff9a9e]" />}
                                                <span className={selectedOption === shuffledLevels[currentLevelIdx].answer ? 'text-[#5a4d44]' : 'text-[#8e7e74]'}>{selectedOption}</span>
                                            </div>
                                            <span className="text-[10px] font-black uppercase tracking-widest opacity-40">Your Choice</span>
                                        </div>

                                        <div className="bg-[#fff9f0] p-6 rounded-[2rem] border-l-8 border-[#ffb7b2] flex gap-4 shadow-sm relative mb-8">
                                            <div className="bg-white p-2 rounded-xl shadow-sm h-fit"><Icon name="lightbulb" size={22} className="text-[#ffb7b2]" /></div>
                                            <div className="text-[15px] leading-relaxed font-bold text-[#7a6a5f]">
                                                <span className="text-[#b8a398] font-black block mb-2 uppercase tracking-tighter not-italic text-[11px]">Thinking Point</span>
                                                {shuffledLevels[currentLevelIdx].thinking}
                                            </div>
                                        </div>

                                        <button onClick={handleGoToNext} className={`mt-auto w-full py-5 rounded-full ${theme.secondary} text-white font-bold text-lg shadow-lg hover:brightness-105 active:scale-95 transition-all flex items-center justify-center gap-3 mb-2`}>
                                            Ê¨°„ÅÆÂïèÈ°å„Å∏ <Icon name="chevronRight" size={20} />
                                        </button>
                                    </div>
                                )}
                                
                                {!showThinkingPoint && combo > 1 && (
                                    <div className="mt-auto text-center pt-4">
                                        <div className="inline-flex items-center gap-2 bg-[#fff0f0] text-[#ff9a9e] px-5 py-2 rounded-full text-[11px] font-black italic shadow-sm animate-bounce">
                                            <Icon name="sparkles" size={12} /> {combo}Âïè„Çå„Çì„Åû„ÅèÔºÅ ÂøÉ„ÅåÊï¥„Å£„Å¶„ÅÑ„Åæ„Åô
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {gameState === 'result' && (
                            <div className="flex-grow flex flex-col items-center justify-center p-12 text-center relative z-10 animate-in zoom-in duration-1000">
                                <div className="bg-[#fff9f0] p-7 rounded-full text-[#e8b69d] mb-8 shadow-inner border-4 border-white relative">
                                    <Icon name="award" size={72} />
                                    <div className="absolute top-0 right-0 animate-pulse text-[#ffb7b2]">
                                        <Icon name="sparkles" size={32} />
                                    </div>
                                </div>
                                <h2 className="text-3xl font-bold mb-3 tracking-tighter leading-tight text-slate-800">ÁâπË®ì„ÄÅ„Åä„Å§„Åã„Çå„Åï„Åæüåø</h2>
                                <p className="text-[#b8a398] font-bold text-[11px] mb-8 tracking-[0.3em] uppercase opacity-70 italic">Final Assessment</p>
                                <div className="text-8xl font-black text-[#ffb7b2] mb-12 tracking-tighter drop-shadow-sm select-none">
                                    {score}<span className="text-3xl text-[#dcd0c9] ml-1">/100</span>
                                </div>
                                
                                <div className="bg-[#fffcf8] p-8 rounded-[3rem] mb-12 w-full border-2 border-[#f5efeb] shadow-inner relative">
                                    <p className="text-[#8e7e74] text-[15px] leading-relaxed italic font-bold">
                                        {score === 100 ? "„ÄêS„É©„É≥„ÇØ„ÄëÂÆåÁíß„Åß„ÅôÔºÅ20„ÅÆÂ§âÊèõ„Çí„Åô„Åπ„Å¶„Åì„Å™„Åó„Åü„ÅÇ„Å™„Åü„ÅØ„ÄÅ„ÇÇ„ÅÜ„Å©„Çì„Å™Ë®Ä„ÅÑÊèõ„Åà„Å´„ÇÇÊÉë„Çè„Åï„Çå„Åæ„Åõ„Çì„ÄÇËá™‰ø°„ÇíÊåÅ„Å£„Å¶Êââ„ÇíÈñã„Åë„Å¶„Åè„Å†„Åï„ÅÑ„Å≠„ÄÇ" : score >= 80 ? "„ÄêA„É©„É≥„ÇØ„ÄëÁ¥†Êô¥„Çâ„Åó„ÅÑÔºÅÂÖ∑‰Ωì„Å®ÊäΩË±°„ÇíÁπã„Åê„Çπ„Éî„Éº„Éâ„ÅåÊ†ºÊÆµ„Å´‰∏ä„Åå„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÊú¨Áï™„ÇÇ„Åù„ÅÆ„É™„Ç∫„É†„ÇíÂ§ßÂàá„Å´„ÄÇ" : "„ÄêB„É©„É≥„ÇØ„Äë„Çà„ÅèÈ†ëÂºµ„Çä„Åæ„Åó„Åü„ÄÇ‰∏ÄÂ∫¶ÈñìÈÅï„Åà„Åü„ÄéThinking Point„Äè„Çí„ÇÜ„Å£„Åè„ÇäË¶ãÁõ¥„Åô„Å†„Åë„Åß„ÄÅÊ¨°„ÅØ„ÇÇ„Å£„Å®Ê•Ω„Å´Ëß£„Åë„Çã„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åô„Çà„ÄÇ"}
                                    </p>
                                </div>

                                <div className="space-y-5 w-full px-4">
                                    <button onClick={startGame} className="w-full text-[#b8a398] hover:text-[#7a6a5f] font-bold py-3 text-xs flex items-center justify-center gap-2 transition-all underline underline-offset-8 decoration-2">
                                        <Icon name="rotateCcw" size={14} /> Êñ∞„Åó„ÅÑÂïèÈ°å„Çª„ÉÉ„Éà„ÅßÂÜçÊåëÊà¶
                                    </button>
                                    <a href="https://note.com/madoka_eng_room" className={`w-full ${theme.primary} ${theme.primaryHover} text-white font-bold py-6 rounded-full flex items-center justify-center gap-2 shadow-xl shadow-[#ffb7b2/20] transition-all active:scale-95 text-lg text-center`}>
                                        „Åæ„Å©„ÅãÂÖàÁîü„ÅÆNote„Å´Êàª„Çã <Icon name="heart" size={22} fill="white" />
                                    </a>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

